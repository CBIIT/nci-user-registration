<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>NCI Registration Portal</title>
    <meta name="generator" content="Bootply" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- bower:css -->
    <link rel="stylesheet" href="/lib/bootstrap/dist/css/bootstrap.min.css" />
    <!-- endbower -->
    <!-- bower:js -->
    <script src="/lib/jquery/dist/jquery.js"></script>
    <script src="/lib/bootstrap/dist/js/bootstrap.js"></script>
    <script src="/lib/bootstrap-validator/dist/validator.js"></script>
    <script src="/lib/typeahead.js/dist/typeahead.bundle.js"></script>
    <!-- endbower -->
    <!-- inject:css -->
    <link rel="stylesheet" href="/css/styles.css">
    <!-- endinject -->
    <!-- inject:js -->
    <!-- endinject -->
    <!--[if lt IE 9]>
			<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
</head>

<body>
    <div class="container-fluid">
        <div class="row top-20">
            <div class="col-sm-2">
                <h3>ADMIN PORTAL</h3>
            </div>
            <div class="col-sm-6 col-sm-offset-1">
                <a href="/">
                    <img class="img-responsive" src="/images/nci-logo-full.svg" alt="National Cancer Institute"></a>
            </div>
            <div class="col-sm-2 col-sm-offset-1">
                <h3>ADMIN PORTAL</h3>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-8 col-sm-offset-2 main-content">
                <div class="row">
                    <div>
                        <form class="form-inline" action="/apps/search" method="post" data-toggle="validator">
                            <div class="form-group">
                                <label for="request_id">Request ID</label>
                                <input type="text" class="form-control" id="request_id" name="request_id" placeholder="Request ID">
                            </div>
                            <button type="submit" class="btn btn-default">Search</button>
                        </form>
                    </div>
                </div>
                <% if (requests.length > 0) {  var numReqs = requests.length; %>
                    <div class="row">
                        <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                            <% for(var i=0; i < numReqs; i++) { var request = requests[i];  %>
                                <div class="panel panel-default">
                                    <div class="panel-heading" role="tab" id="heading<%=i%>">
                                        <h4 class="panel-title">
                                            <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseElem<%=i%>" aria-controls="collapse<%=i%>"
                                                aria-expanded=<% if (numReqs===1 ) { %>"true"<%} else {%>"false"<%}%> >
                                            <%=request.user_dn%> | <%=request.requested_app%>
                                        </a>
                                        </h4>
                                    </div>
                                    <div id="collapseElem<%=i%>" class="panel-collapse collapse <% if (numReqs === 1) { %>in<%}%>" role="tabpanel" aria-labelledby="heading<%=i%>">
                                        <div class="panel-body">
                                            <p>Requested application:
                                                <% if (request.requested_app) {%>
                                                    <%=request.requested_app%>
                                                        <%}%>
                                            </p>
                                            <p>User DN:
                                                <% if (request.user_dn) {%>
                                                    <%=request.user_dn%>
                                                        <%}%>
                                            </p>
                                            <p>Requested Access Level:
                                                <% if (request.reqauested_access_level) {%>
                                                    <%=request.requested_access_level%>
                                                        <%}%>
                                            </p>
                                            <p>User Justification:
                                                <% if (request.justification) {%>
                                                    <%=request.justification%>
                                                        <%}%>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <%}%>
                        </div>
                    </div>
                    <%}%>
            </div>
        </div>
    </div>
    <script>

var groups = new Bloodhound({
  datumTokenizer: Bloodhound.tokenizers.whitespace,
  queryTokenizer: Bloodhound.tokenizers.whitespace,
  prefetch: {
      url: 'http://localhost:8090/apps/getAllGroups',
      cache: false,
      cacheKey: groups,
      transform: function(response) {
          return $.map(response, function(groupObj) {
              return groupObj.dn;
          });
      }
  }
});

$('#groupInput1 .typeahead').typeahead({
  hint: true,
  highlight: true,
  minLength: 1,
},
{
  name: 'groups',
  source: groups,
  limit: 8  
});

$('#groupInput2 .typeahead').typeahead({
  hint: true,
  highlight: true,
  minLength: 1
},
{
  name: 'groups',
  source: groups,
  limit: 8
});

$('#groupInput3 .typeahead').typeahead({
  hint: true,
  highlight: true,
  minLength: 1
},
{
  name: 'groups',
  source: groups,
  limit:8
});

        </script>
</body>

</html>